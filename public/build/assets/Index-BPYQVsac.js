import{r as g,x as y,j as e,Q as _,S as q}from"./app-C1-BhYwW.js";import{A as M,S as $}from"./AdminAuthenticatedLayout-n8nHtuKB.js";import{B as o}from"./button-B7iXgecm.js";import{C as J,a as K,b as V,c as W,d as X}from"./card-Cq9wpWkT.js";import{T as Y,a as Z,b,c as x,d as G,e as h}from"./table-CbKei3Q8.js";import{D as S,a as ee,b as D,c as R,d as w,e as P,f as T}from"./dialog-DkuFctmz.js";import{I as k}from"./input-Ce-XynMX.js";import{L as d}from"./label-BxCSsw1S.js";import{B as f}from"./badge-BIDVpDsY.js";import{C as O}from"./checkbox-DbRyMG1Q.js";import{S as se}from"./scroll-area-CXmJVZjA.js";import{S as ae}from"./breadcrumb-CoyL08EQ.js";import{t as N}from"./index-BfJCq-8N.js";import{P as te}from"./plus-Dt1WVr8s.js";import{S as ie}from"./square-pen-fpqEKr98.js";import{T as ne}from"./trash-2-9Gx35m9l.js";import"./index-CjdBt_RI.js";import"./createLucideIcon-D19Eww6g.js";import"./index-CHYIVxX6.js";import"./clsx-B-dksMZM.js";import"./index-D_Gva4nH.js";import"./index-alOraRYz.js";import"./index-AUv1zfk2.js";import"./chevron-right-Dobkmf49.js";import"./avatar-B35DdgwT.js";import"./calendar-PcuVg9g_.js";import"./award-sqH3_Nw-.js";import"./index-qk1iyDqg.js";import"./index-BRzXs5-t.js";import"./index-ChosiiE7.js";import"./index-BdQq_4o_.js";function He({roles:A,permissionGroups:p}){const[E,v]=g.useState(!1),[B,j]=g.useState(!1),[m,F]=g.useState(null),c=y({name:"",permissions:[]}),l=y({name:"",permissions:[]}),I=s=>{s.preventDefault(),c.post(route("admin.roles.store"),{onSuccess:()=>{v(!1),c.reset(),N.success("Role created successfully!")}})},H=s=>{F(s),l.setData({name:s.name,permissions:s.permissions.map(a=>a.name)}),j(!0)},L=s=>{s.preventDefault(),l.put(route("admin.roles.update",m.id),{onSuccess:()=>{j(!1),l.reset(),N.success("Role updated successfully!")}})},U=s=>{confirm(`Are you sure you want to delete the role "${s.name}"?`)&&q.delete(route("admin.roles.destroy",s.id),{onSuccess:()=>N.success("Role deleted successfully!")})},z=(s,a)=>{const i=s.data.permissions;i.includes(a)?s.setData("permissions",i.filter(t=>t!==a)):s.setData("permissions",[...i,a])},Q=(s,a)=>{const i=a.map(n=>n.name),t=s.data.permissions;if(i.every(n=>t.includes(n)))s.setData("permissions",t.filter(n=>!i.includes(n)));else{const n=[...new Set([...t,...i])];s.setData("permissions",n)}},C=({form:s,permissionGroups:a})=>e.jsx(se,{className:"h-[400px] pr-4",children:!a||Object.keys(a).length===0?e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No permissions found. Run seeders?"}):Object.entries(a).map(([i,t])=>{const u=t.every(r=>s.data.permissions.includes(r.name)),n=t.some(r=>s.data.permissions.includes(r.name));return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(O,{checked:u,onCheckedChange:()=>Q(s,t),className:n&&!u?"opacity-50":""}),e.jsx(d,{className:"text-sm font-semibold text-gray-700",children:i}),e.jsx(f,{variant:"outline",className:"ml-auto",children:t.length})]}),e.jsx("div",{className:"ml-6 space-y-2",children:t.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{checked:s.data.permissions.includes(r.name),onCheckedChange:()=>z(s,r.name)}),e.jsx(d,{className:"text-sm text-gray-600 cursor-pointer",children:r.name})]},r.id))}),e.jsx(ae,{className:"mt-4"})]},i)})});return console.log("Permission Groups:",p),e.jsxs(M,{children:[e.jsx(_,{title:"Role Management"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Roles & Permissions"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create roles and assign permissions to control access"})]}),e.jsxs(S,{open:E,onOpenChange:v,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(o,{className:"bg-red-600 hover:bg-red-700",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),"Create New Role"]})}),e.jsx(D,{className:"max-w-2xl",children:e.jsxs("form",{onSubmit:I,children:[e.jsxs(R,{children:[e.jsx(w,{children:"Create New Role"}),e.jsx(P,{children:"Create a new role and assign permissions"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"name",children:"Role Name"}),e.jsx(k,{id:"name",value:c.data.name,onChange:s=>c.setData("name",s.target.value),placeholder:"e.g., moderator"})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Permissions"}),e.jsx(C,{form:c,permissionGroups:p})]})]}),e.jsx(T,{children:e.jsx(o,{type:"submit",disabled:c.processing,children:"Create Role"})})]})})]})]}),e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx(V,{children:"All Roles"}),e.jsx(W,{children:"Edit existing roles and their permissions"})]}),e.jsx(X,{children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(b,{children:[e.jsx(x,{children:"Role Name"}),e.jsx(x,{children:"Permissions"}),e.jsx(x,{children:"Created"}),e.jsx(x,{className:"text-right",children:"Actions"})]})}),e.jsx(G,{children:A.map(s=>e.jsxs(b,{children:[e.jsx(h,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4 text-red-600"}),s.name,s.name==="superadmin"&&e.jsx(f,{variant:"destructive",children:"Super"})]})}),e.jsx(h,{children:e.jsxs(f,{variant:"outline",children:[s.permissions_count," permissions"]})}),e.jsx(h,{className:"text-gray-600",children:new Date(s.created_at).toLocaleDateString()}),e.jsxs(h,{className:"text-right space-x-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>H(s),children:e.jsx(ie,{className:"h-4 w-4"})}),s.name!=="superadmin"&&e.jsx(o,{variant:"destructive",size:"sm",onClick:()=>U(s),children:e.jsx(ne,{className:"h-4 w-4"})})]})]},s.id))})]})})]}),e.jsx(S,{open:B,onOpenChange:j,children:e.jsx(D,{className:"max-w-2xl",children:e.jsxs("form",{onSubmit:L,children:[e.jsxs(R,{children:[e.jsx(w,{children:"Edit Role"}),e.jsx(P,{children:"Update role name and permissions"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"edit-name",children:"Role Name"}),e.jsx(k,{id:"edit-name",value:l.data.name,onChange:s=>l.setData("name",s.target.value),disabled:(m==null?void 0:m.name)==="superadmin"})]}),e.jsxs("div",{children:[e.jsx(d,{children:"Permissions"}),e.jsx(C,{form:l,permissionGroups:p})]})]}),e.jsx(T,{children:e.jsx(o,{type:"submit",disabled:l.processing,children:"Update Role"})})]})})})]})]})}export{He as default};
